#!/usr/bin/env python3
#
# List the Common Vulnerabilities and Exposures for software packages in z/OS Open Tools
#
cve_site="https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json"
cve_ca="../cacert.pem"
product_list="OpenSSL Bash"

import ssl
context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)
context.load_verify_locations(cve_ca)

import urllib.request, json 
with urllib.request.urlopen(cve_site,context=context) as url:
    data = json.loads(url.read().decode())
    for cve in data['vulnerabilities']:
        if cve['product'] != '' and cve['product'] in product_list:
            print(cve)

